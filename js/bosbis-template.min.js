var Template;!function(){"use strict";function t(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function e(){var t=document.createElement("div");return t.style.cssText="display: table-cell;width: 40px;padding-bottom: 19.25%;height: 0;",t}function i(){var t=document.createElement("div");return t.style.cssText="clear: both;display: table;",t}function o(t){t.style.cssText=t.style.cssText.concat(L.sprite,L.seat,L.available),t.dataset.seatId=z.available,t.addEventListener("click",f,!1)}function s(t){t.style.cssText=t.style.cssText.concat(L.sprite,L.seat,L.booked),t.dataset.seatId=z.booked,t.addEventListener("click",g,!1)}function n(t){t.style.cssText=t.style.cssText.concat(L.sprite,L.seat,L.sold),t.dataset.seatId=z.sold,t.addEventListener("click",v,!1)}function c(t){t.style.cssText=t.style.cssText.concat(L.sprite,L.seat,L.picked),t.dataset.seatId=z.picked,t.addEventListener("click",m,!1)}function r(t){t.style.cssText=t.style.cssText.concat(L.sprite,L.seat,L.driver),t.dataset.seatId=z.driver,t.addEventListener("click",y,!1)}function a(t,e){k()||p()?0==e?t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.toilet1):t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.toilet2):0==e?t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.toilet2):t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.toilet1)}function l(t,e){k()||p()?0==e?t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.smoking1):t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.smoking2):0==e?t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.smoking2):t.style.cssText=t.style.cssText.concat(L.sprite,L.room,L.smoking1)}function d(){return p()?B:P}function u(t){return document.querySelector("[data-seat-number='"+t+"']")}function p(){return!I.templateAlign.match(/horizontal/gi)}function k(){return!I.align.match(/right/gi)}function f(t){var e=I.beforePick(h(this),this);e||(c(this),this.removeEventListener("click",f),I.clickAvailable(h(this),this))}function m(){o(this),this.removeEventListener("click",m),I.clickPicked(h(this),this)}function b(t){if(t.dataset.seatId==z.available)t.removeEventListener("click",f);else if(t.dataset.seatId==z.picked)t.removeEventListener("click",m);else if(t.dataset.seatId==z.booked)t.removeEventListener("click",g);else{if(t.dataset.seatId!=z.sold)return!1;t.removeEventListener("click",v)}return!0}function g(){I.clickBooked(h(this),this)}function v(){I.clickSold(h(this),this)}function y(){I.clickDriver(h(this),this)}function h(t){return t.dataset.seatNumber}function T(){return x().length}function x(){return document.querySelectorAll("[data-seat-id='"+z.picked+"']")}function S(){var t=I.seatMatrix.split(","),d=0,u=0,f=0,m=0,b=0,g=[],v=document.querySelector(I.seatContainer);v.innerHTML="";for(var y in t){var h=t[y].split("-"),T=e();switch(0==f&&b++,h[2]){case"D":r(T);break;case"S":var x=h[3].trim();-1!==I.bookedSeats.indexOf(x)?s(T):-1!==I.soldSeats.indexOf(x)?n(T):-1!==I.pickedSeats.indexOf(x)?c(T):-1!==I.availableSeats.indexOf(x)?o(T):I.isRestSold?n(T):o(T),T.title="#"+x,T.dataset.seatNumber=x;break;case"T":a(T,d),d++;break;case"R":l(T,u),u++}p()?0==m?g[f]=[T]:k()?g[f].push(T):g[f].unshift(T):(k()?0==f?g.unshift([T]):g[g.length-m-1].push(T):0==f?g[m]=[T]:g[m].push(T),b=f+1),m++,"B"==h[0]&&(f++,m=0)}for(var S in g)for(var E in g[S])g[S][E].style.paddingBottom=100/b+"%",v.appendChild(g[S][E]),E==g[S].length-1&&v.appendChild(i())}function E(t,e){for(var i in t){var o=u(t[i]);if(!b(o))return;e(o)}}var L={},I={align:"left",seatMatrix:null,seatContainer:null,availableSeats:[],pickedSeats:[],bookedSeats:[],soldSeats:[],isRestSold:!1,templateAlign:"horizontal",seatClicked:function(){},beforePick:function(){},clickAvailable:function(){},clickPicked:function(){},clickBooked:function(){},clickSold:function(){},clickDriver:function(){}},B={sprite:"background-image:url(images/sprite_seat_vertical.png);background-repeat: no-repeat;",seat:"background-size: 1000%;",room:"background-size: 500%;",driver:"background-position:1.5% 8.2%;cursor:pointer;",available:"background-position:13.2% 8.2%;cursor:pointer",sold:"background-position:25.5% 8.2%;cursor:pointer;",booked:"background-position:38.5% 8.2%;cursor:pointer;",picked:"background-position:51.2% 8.2%;cursor:pointer",toilet1:"background-position:71.3% 8.2%;width: 80px;padding-Bottom: 9.62%;",toilet2:"display:none;",smoking1:"background-position:98.3% 8.2%;width: 80px;padding-Bottom: 9.62%;",smoking2:"display:none;"},P={sprite:"background-size: 100%;background-image: url(images/sprite_seat_horizontal.png);background-repeat: no-repeat;",seat:"",room:"",driver:"background-position: 0% 0.5%;cursor:pointer;",available:"background-position: 0% 50%;cursor:pointer;",sold:"background-position: 0% 38%;cursor:pointer;",booked:"background-position: 0% 25%;cursor:pointer;",picked:"background-position: 0% 12.5%;cursor:pointer;",toilet1:"background-position: 0% 97.8%;",toilet2:"background-position:0% 87%;",smoking1:"background-position: 0% 73.8%;",smoking2:"background-position: 0% 63%;"},z={driver:"driver",available:"available",picked:"picked",booked:"booked",sold:"sold"};Template=function(e){I=t(I,e),L=d(),S(this)},Template.prototype.setOptions=function(e){I=t(I,e)},Template.prototype.regen=function(e){e&&(I=t(I,e)),L=d(),S()},Template.prototype.getPickedSeats=function(){return x()},Template.prototype.getPickedSum=function(){return T()},Template.prototype.setSold=function(t){E(t,n)},Template.prototype.setBooked=function(t){E(t,s)}}();